#include<stdio.h>
#include "Plansza.c"
int oddechy(plansza* stol,int pole,int rozmiar){
    int oddechy = 4;
    if(pole % rozmiar != rozmiar - 1){
        
        if(stol->wartosci[pole + 1] != " ")
            oddechy -= 1;
        }
        
        else
            oddechy -= 1;
    
    if(pole % rozmiar != 0){
        
        if(stol->wartosci[pole - 1] != " ")
            oddechy -= 1;
    }
    
    else
        oddechy -= 1;
        
    if(pole >= rozmiar){
        
        if(stol->wartosci[pole - rozmiar] != " ")
                oddechy -= 1;
            }
    else
        oddechy -= 1;
    
    if(pole < rozmiar * (rozmiar - 1)){
            
            if(stol->wartosci[pole + rozmiar] != " ")
                oddechy -= 1;
            }
    else
        oddechy -= 1;

    return oddechy;
}
int niszczenie(plansza* stol,int rozmiar,int pole,int* sprawdzone)
{
    int dodatki[] = {1,-1,13,-13};
    if(stol->wartosci[pole] != " " && oddechy(stol,pole,rozmiar) == 0 && sprawdzone[pole] == 0){
        for(int i = 0;i < 4;i++){
            sprawdzone[pole] = 1;
            if(stol->wartosci[pole] == stol->wartosci[pole + dodatki[i]] && sprawdzone[pole + dodatki[i]] == 0){
                printf("%d",pole + dodatki[i]);
                sprawdzone[pole + dodatki[i]] = 1;
                if(niszczenie(stol,rozmiar,pole + dodatki[i],sprawdzone) == 0)
                    break;


            }
            for(int j = 0;j < rozmiar * rozmiar;j++){
                stol->wartosci[pole] == " ";
                if(sprawdzone[j]){
                    stol->wartosci[j] = " ";
                    sprawdzone[j] = 0;
                }
            }
        }
    }
    else
        return 0;
}

void postaw_pionek(plansza* stol,int rozmiar,int pole,char gracz[1])
{
    stol->wartosci[pole] = gracz;
    int* sprawdzone [169] = {};     //wskażnik musi być bo wywala błąd, sprawdzone to lista po to zeby nie chodził w kółko w grupie
    for(int i = 0;i < rozmiar * rozmiar;i++){
        niszczenie(stol,13,i,sprawdzone);
    }
    wypisz(stol,13);
}
void main()
{
    plansza* stol = utworz_plansze(stol,13);
    postaw_pionek(stol,13,100,"O");
    postaw_pionek(stol,13,101,"O");
    postaw_pionek(stol,13,114,"O");
    postaw_pionek(stol,13,99,"X");
    postaw_pionek(stol,13,113,"X");
    postaw_pionek(stol,13,114,"O");
    postaw_pionek(stol,13,115,"X");
    postaw_pionek(stol,13,102,"X");
    postaw_pionek(stol,13,87,"X");
    postaw_pionek(stol,13,88,"X");
    postaw_pionek(stol,13,89,"X");
    postaw_pionek(stol,13,127,"X");
    
}
